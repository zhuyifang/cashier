(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-appraise-appraise"],{"0ace":function(e,t,a){"use strict";var o=a("5e1c"),i=a.n(o);i.a},"1cee":function(e,t,a){"use strict";a.r(t);var o=a("7340"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(n);t["default"]=i.a},"2a23":function(e,t,a){"use strict";var o;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"app-upload-image"},[a("v-uni-view",{staticClass:"upload-box",style:{background:e.backgroundColor}},[a("v-uni-view",{staticClass:"flex-wrap"},[e._l(e.imageList,(function(t,o){return a("v-uni-view",{key:t.id,staticClass:"img-box"},[a("v-uni-view",{staticClass:"remove cross-center main-center",attrs:{mode:"aspectFill"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.remove(o)}}},[e._v("x")]),a("v-uni-image",{staticClass:"img",attrs:{src:t,mode:"aspectFill"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.previewImage(o)}}})],1)})),a("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}},[e.isAddImg?a("v-uni-view",{staticClass:"add-img dir-top-nowrap cross-center main-center",class:{"other-border":!!e.diy},style:{margin:e.margin+"rpx"}},[a("v-uni-image",{staticClass:"add-img-icon",attrs:{mode:"aspectFill",src:e.defaultImg}}),a("v-uni-text",{staticClass:"text"},[e._v(e._s(e.text))]),e.showNumber?a("v-uni-text",{staticClass:"text"},[e._v("(最多"+e._s(e.maxNum)+"张)")]):e._e()],1):e._e()],1)],2)],1)],1)},n=[]},"2f46":function(e,t,a){t=e.exports=a("24fb")(!1),t.push([e.i,".text-center[data-v-31b24196]{text-align:center}.font-weight[data-v-31b24196]{font-weight:700}.page-width[data-v-31b24196]{width:100%}.goods-hover-class[data-v-31b24196]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-31b24196]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}uni-page-body[data-v-31b24196]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-31b24196]{width:100%}.u-hover-class[data-v-31b24196]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-31b24196]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.appraise-box[data-v-31b24196]{margin:%?24?%}.form-box .item-box[data-v-31b24196]{border-radius:%?15?%;background-color:#fff;padding:%?24?% %?20?%;width:100%;margin-bottom:%?24?%}.form-box .goods_pic[data-v-31b24196]{width:%?100?%;height:%?100?%}.form-box .goods_name[data-v-31b24196]{margin-left:%?16?%;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.form-box .anonymous-text[data-v-31b24196]{font-size:%?22?%;color:#999}.form-box .grade-box[data-v-31b24196]{margin:%?32?% %?24?%}.form-box .grade-icon[data-v-31b24196]{width:%?68?%;height:%?68?%}.form-box .grade-item[data-v-31b24196]{height:100%}.form-box .grade-item .title[data-v-31b24196]{margin-top:%?12?%}.form-box .grade-item .active-title[data-v-31b24196]{color:#ff4544}.form-box .content-box[data-v-31b24196]{background-color:#f7f7f7;margin-top:%?20?%;padding:%?24?% %?24?% 0;border-top-left-radius:%?5?%;border-top-right-radius:%?5?%}.form-box .content[data-v-31b24196]{height:100%;width:100%}.form-box .image-box[data-v-31b24196]{padding:%?24?%;background-color:#f7f7f7;border-bottom-left-radius:%?5?%;border-bottom-right-radius:%?5?%}.form-box .btn[data-v-31b24196]{background-color:#ff4544;border-radius:%?40?%;color:#fff;width:100%;margin-top:%?50?%}.form-box .check-icon[data-v-31b24196]{width:%?28?%;height:%?28?%;margin-right:%?8?%;margin-top:%?5?%}body.?%PAGE?%[data-v-31b24196]{background:#f7f7f7}",""])},"3cb3":function(e,t,a){"use strict";var o=a("5b91"),i=a.n(o);i.a},"5b91":function(e,t,a){var o=a("b95e");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=a("4f06").default;i("44fb0eb4",o,!0,{sourceMap:!1,shadowMode:!1})},"5e1c":function(e,t,a){var o=a("2f46");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=a("4f06").default;i("448c62e2",o,!0,{sourceMap:!1,shadowMode:!1})},7340:function(e,t,a){"use strict";var o=a("4ea4");a("8e6e"),a("456d"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("7f7f"),a("ac6a");var i=o(a("bd86")),n=a("2f62"),r=o(a("798e"));function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={components:{"app-upload-image":r.default},data:function(){return{id:null,maxNum:6,appraiseData:[],is_show:!1}},computed:c({},(0,n.mapState)({scoreImg:function(e){return e.mallConfig.__wxapp_img.mall}})),methods:{getOrderDetail:function(){var e=this;e.$showLoading(),e.$request({url:e.$api.order.detail,data:{id:this.id}}).then((function(t){if(e.$hideLoading(),0===t.code){var a=t.data.detail,o=[];a.detail.forEach((function(t){console.log(t),o.push({id:t.id,goods_pic_url:t.goods_info.pic_url?t.goods_info.pic_url:t.goods.goodsWarehouse.cover_pic,goods_name:t.goods?t.goods.goodsWarehouse.name:t.goods_info?t.goods_info.name:"",content:"",pic_list:[],grade:[{id:3,title:"好评",active:!0,text_color:"#ff4544",active_icon:e.scoreImg.score_3_active,icon:e.scoreImg.score_3},{id:2,title:"中评",active:!1,text_color:"#ff964a",active_icon:e.scoreImg.score_2_active,icon:e.scoreImg.score_2},{id:1,title:"差评",active:!1,text_color:"#606e78",active_icon:e.scoreImg.score_1_active,icon:e.scoreImg.score_1}],grade_level:3,is_anonymous:!1})})),console.log(o),e.appraiseData=o,e.is_show=!0}else uni.showModal({title:"",content:t.msg,showCancel:!1}),uni.navigateBack()})).catch((function(){e.$hideLoading()}))},imageEvent:function(e){var t=this,a=e.sign,o=e.imageList;t.appraiseData.forEach((function(e){if(e.id===a)return e.pic_list=o,!1})),this.appraiseData=t.appraiseData},grade:function(e,t,a){t.grade.forEach((function(e){e.active=!1})),e.active=!0,0==a&&(t.grade_level=3),1==a&&(t.grade_level=2),2==a&&(t.grade_level=1)},checkedChange:function(e){e.is_anonymous=!e.is_anonymous},formSubmit:function(){var e=this;uni.showLoading({title:"提交中"}),e.$request({url:e.$api.order.appraise,method:"post",data:{appraiseData:JSON.stringify(e.appraiseData),order_id:e.id}}).then((function(t){uni.hideLoading(),0===t.code?uni.redirectTo({url:"/pages/order/appraise-finish/index?id=".concat(e.id)}):uni.showModal({title:"",content:t.msg,showCancel:!1})})).catch((function(){uni.hideLoading()}))},inputEvent:function(e){var t=this,a=e.id,o=e.value;t.appraiseData.forEach((function(e){e.id!=a||(e.content=o)})),this.appraiseData=t.appraiseData}},onLoad:function(e){this.$commonLoad.onload(e),this.id=e.id,this.getOrderDetail()}};t.default=d},"798e":function(e,t,a){"use strict";a.r(t);var o=a("2a23"),i=a("d877");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("3cb3");var r,s=a("f0c5"),c=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"6b26748e",null,!1,o["a"],r);t["default"]=c.exports},"91aa":function(e,t,a){"use strict";var o;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-layout",[e.is_show?a("v-uni-view",{staticClass:"appraise-box"},[a("v-uni-form",{staticClass:"form-box"},[e._l(e.appraiseData,(function(t){return a("v-uni-view",{key:t.id,staticClass:"item-box"},[a("v-uni-view",{staticClass:"dir-left-nowrap"},[a("v-uni-view",{staticClass:"box-grow-0"},[a("v-uni-image",{staticClass:"goods_pic",attrs:{mode:"aspectFill",src:t.goods_pic_url}})],1),a("v-uni-view",{staticClass:"box-grow-1 dir-left-nowrap cross-center"},[a("v-uni-text",{staticClass:"box-grow-1 goods_name t-omit-two"},[e._v(e._s(t.goods_name))]),a("v-uni-view",{staticClass:"box-grow-0",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.checkedChange(t)}}},[t.is_anonymous?a("v-uni-image",{staticClass:"check-icon",attrs:{src:"/static/image/icon/icon-checkbox-checked-a.png"}}):a("v-uni-image",{staticClass:"check-icon",attrs:{src:"/static/image/icon/form-er.png"}})],1),a("v-uni-view",{staticClass:"anonymous-text box-grow-0",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.checkedChange(t)}}},[e._v("匿名评价")])],1)],1),a("v-uni-view",{staticClass:"dir-left-nowrap grade-box"},e._l(t.grade,(function(o,i){return a("v-uni-view",{key:o.id,staticClass:"dir-top-nowrap box-grow-1 cross-center main-center grade-item",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.grade(o,t,i)}}},[a("v-uni-image",{staticClass:"grade-icon",attrs:{src:o.active?o.active_icon:o.icon}}),a("v-uni-text",{staticClass:"title",class:{"active-title":!!o.active},style:{color:o.active?o.text_color:""}},[e._v(e._s(o.title))])],1)})),1),a("v-uni-view",{staticClass:"content-box"},[a("v-uni-view",{staticClass:"box-grow-1"},[a("v-uni-textarea",{staticClass:"content",attrs:{placeholder:"请输入评价内容","auto-height":!0},model:{value:t.content,callback:function(a){e.$set(t,"content",a)},expression:"item.content"}})],1)],1),a("v-uni-view",{staticClass:"image-box"},[a("app-upload-image",{attrs:{sign:t.id,count:6,maxNum:e.maxNum},on:{imageEvent:function(t){arguments[0]=t=e.$handleEvent(t),e.imageEvent.apply(void 0,arguments)}}})],1)],1)})),e.appraiseData.length?a("v-uni-button",{staticClass:"btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[e._v("提交")]):e._e()],2)],1):e._e()],1)},n=[]},b95e:function(e,t,a){t=e.exports=a("24fb")(!1),t.push([e.i,".text-center[data-v-6b26748e]{text-align:center}.font-weight[data-v-6b26748e]{font-weight:700}.page-width[data-v-6b26748e]{width:100%}.goods-hover-class[data-v-6b26748e]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-6b26748e]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}uni-page-body[data-v-6b26748e]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-6b26748e]{width:100%}.u-hover-class[data-v-6b26748e]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-6b26748e]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.upload-box[data-v-6b26748e]{background-color:#fff}.upload-box .title[data-v-6b26748e]{padding:%?15?% 0 %?15?% %?20?%}.upload-box .img[data-v-6b26748e]{width:%?188?%;height:%?188?%;margin:%?10?%;display:block}.upload-box .add-img[data-v-6b26748e]{width:%?188?%;height:%?188?%;border:%?1?% dotted #e2e2e2;background-color:#fff}.upload-box .add-img .text[data-v-6b26748e]{color:#999;font-size:%?22?%}.upload-box .add-img-icon[data-v-6b26748e]{width:%?56?%;height:%?56?%;margin-bottom:%?10?%}.upload-box .img-box[data-v-6b26748e]{position:relative}.upload-box .remove[data-v-6b26748e]{width:%?40?%;height:%?40?%;position:absolute;right:%?-5?%;top:%?-10?%;background:#ff4544;color:#fff;border-radius:50%;padding-bottom:%?8?%;font-size:%?24?%;z-index:968}.upload-box .add-img.other-border[data-v-6b26748e]{border:%?1?% solid #e2e2e2}body.?%PAGE?%[data-v-6b26748e]{background:#f7f7f7}",""])},cc49:function(e,t,a){"use strict";a.r(t);var o=a("91aa"),i=a("1cee");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("0ace");var r,s=a("f0c5"),c=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"31b24196",null,!1,o["a"],r);t["default"]=c.exports},d5ea:function(e,t,a){"use strict";var o=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a("f854")),n=(o(a("e143")),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t,a){(0,i.default)(e,"file").then((function(t){e.success({res:"",header:t})}))}))}),r=n;t.default=r},d877:function(e,t,a){"use strict";a.r(t);var o=a("ee1b"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(n);t["default"]=i.a},ee1b:function(e,t,a){"use strict";var o=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("c5f6");var i=o(a("d5ea")),n={name:"app-upload-image",props:{value:{default:null},defaultImg:{type:String,default:"/static/image/icon/icon-image.png"},maxNum:{type:[Number,String],default:3},sign:{type:String,default:""},backgroundColor:{type:String,default:"#f7f7f7"},margin:{type:String,default:"10"},diy:{type:Boolean,default:!1},showNumber:{type:Boolean,default:!0},text:{type:String,default:"上传图片"},count:{type:Number,default:9}},data:function(){return{imageList:this.value?this.value:[],isAddImg:!0}},methods:{checkMaxNum:function(){var e=!(this.imageList.length>=this.maxNum);this.isAddImg=e},remove:function(e){var t=this.imageList;t.splice(e,1);this.imageList=t,this.checkMaxNum(),this.$emit("imageEvent",{imageList:t,sign:this.sign})},chooseImage:function(){var e=this,t=e.imageList;uni.chooseImage({count:Number(e.maxNum),success:function(a){var o=function(o){if(o>=e.maxNum-t.length)return"break";var n=new Image;n.src=a.tempFilePaths[o],n.onload=function(){var t=document.createElement("canvas");t.width=n.width,t.height=n.height;var a=t.getContext("2d");a.drawImage(n,0,0,n.width,n.height);var o=n.src.substring(n.src.lastIndexOf(".")+1).toLowerCase(),r=t.toDataURL("image/"+o);(0,i.default)({url:e.$api.upload.file,maxNum:e.maxNum,success:function(t){t.res;var a=t.header;e.$request({url:e.$api.upload.file+"&name=base64",header:a,method:"post",data:{database:r}}).then((function(t){0===t.code?(e.imageList.push(t.data.url),e.checkMaxNum(),e.$emit("imageEvent",{imageList:e.imageList,sign:e.sign})):uni.showModal({title:"",content:t.msg,showCancel:!1})}))}})}};for(var n in a.tempFilePaths){var r=o(n);if("break"===r)break}},complete:function(a){e.$emit("imageEvent",{imageList:t,sign:e.sign})}})},previewImage:function(e){var t=this.imageList;uni.previewImage({current:t[e],urls:t})},createObjectURL:function(e){return window.URL?window.URL.createObjectURL(e):window.webkitURL.createObjectURL(e)}},created:function(){this.checkMaxNum()}};t.default=n},f854:function(e,t,a){"use strict";var o=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("a481"),a("96cf");var i=o(a("3b8d")),n=a("8de3"),r=o(a("e143")),s=o(a("4360")),c=a("b1c7"),d=o(a("36e8")),u=function(){var e=(0,i.default)(regeneratorRuntime.mark((function e(t,a){var o,i,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o={"X-App-Platform":t.header&&t.header["X-App-Platform"]?t.header["X-App-Platform"]:r.default.prototype.$platform,"X-Form-Id-List":JSON.stringify((0,n.popAll)()),"X-Requested-With":t.header&&t.header["X-Requested-With"]?t.header["X-Requested-With"]:"XMLHttpRequest","X-App-Version":r.default.prototype.$appVersion,"content-type":a?"multipart/form-data":"application/x-www-form-urlencoded"},e.next=3,s.default.dispatch("user/loadAccessTokenFormCache");case 3:return s.default.state.user&&s.default.state.user.accessToken&&(o["X-Access-Token"]=s.default.state.user.accessToken),s.default.state.user&&0!==s.default.state.user.tempParentId&&(o["X-User-Id"]=s.default.state.user.tempParentId+""),i={},t.url.replace(/([^=&]+)=([^&]*)/g,(function(e,t,a){i[decodeURIComponent(t)]=decodeURIComponent(a)})),-1!==(0,c.objectValues)(d.default.mch).indexOf(i.r)&&(u=r.default.prototype.$storage.getStorageSync("MCH2019"),o["Mch-Access-Token"]=u.token),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),l=u;t.default=l}}]);