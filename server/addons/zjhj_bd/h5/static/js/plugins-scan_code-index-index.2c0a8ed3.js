(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins-scan_code-index-index"],{"1db3":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAMAAADW3miqAAAAYFBMVEUAAACtra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra0WMtvAAAAAH3RSTlMAYg+dc6jo07cGW0xpPDDNxpWRiYUe21Mm8L97QzYYIzOmfgAAAV9JREFUOMt9k+uSQ0AQhZsxF8RdCDb53v8tt5JSS0/Jnj8Mn+nW54xo3eetH7PiIV9VmYldLpSXyI8HlsZ2nWkd4BKJ9bLg+lp2PTYPzTOqtMCYq0c3B2qzEsJdIuUdZIrp5EK3E/WCXi6VwM9+27DKF42Q7/iSqje1HGown+tCoYbe0BwfPeC9KHBqnwGojmX4bOXJFJTBlJ5qg0gOuR5Ptqm1o5ISL//KMMiAicOgnS2wYqOWigAqTk9WCdzOeXEQQTWttGco99aCkxgKqlwuK5gIWmXQAUgB3XiJlZlWhRjQgezpJIXIdv+uesgzi0wUynXszd9P4YdP/CbdEsxq4OF9gUpBQ3r+kX1qG9PZk5dq2xJ2n3XEtXHs/dVqNNq3w48EsiumBKPSOF4eOxsdMF9qpA7EvVYThCI/KlmgkFgZQDsk5ZyM6wKY9KLNNGv5kx8Oa2Ju3vrOmDHRxC9lch6LtN1nUgAAAABJRU5ErkJggg=="},3043:function(t,e,a){"use strict";var i=a("ded4"),n=a.n(i);n.a},"92c0":function(t,e,a){"use strict";a.r(e);var i=a("b7d0"),n=a("9812");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("3043");var s,r=a("f0c5"),c=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"33f564e3",null,!1,i["a"],s);e["default"]=c.exports},9812:function(t,e,a){"use strict";a.r(e);var i=a("d5e0"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},ab4a:function(t,e,a){e=t.exports=a("24fb")(!1);var i=a("b605"),n=i(a("db8d")),o=i(a("1db3")),s=i(a("afd4")),r=i(a("cf9d"));e.push([t.i,".text-center[data-v-33f564e3]{text-align:center}.font-weight[data-v-33f564e3]{font-weight:700}.page-width[data-v-33f564e3]{width:100%}.goods-hover-class[data-v-33f564e3]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-33f564e3]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}uni-page-body[data-v-33f564e3]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-33f564e3]{width:100%}.u-hover-class[data-v-33f564e3]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-33f564e3]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.red[data-v-33f564e3]{color:#ff4544}.gray[data-v-33f564e3]{color:#999}.scan-head[data-v-33f564e3]{margin:%?20?% %?24?% 0 %?24?%;background:#fff;border-radius:%?16?%;padding:%?48?% %?40?% 0 %?40?%;font-size:%?28?%;color:#353535}.scan-head .scan-line[data-v-33f564e3]{height:1px;margin-top:%?38?%;background:#e2e2e2}.scan-head .scan-price[data-v-33f564e3]{margin-top:%?32?%}.scan-head .scan-price .order-key[data-v-33f564e3]{font-size:%?50?%}.scan-head .scan-price .order-value[data-v-33f564e3]{font-size:%?80?%;padding-left:%?28?%;height:%?98?%}.scan-offer[data-v-33f564e3]{color:#666;font-size:%?28?%;margin-top:%?40?%}.scan-offer .coupon-right[data-v-33f564e3]{padding-right:%?12?%}.scan-offer .icon-right[data-v-33f564e3]{background-size:100% auto;background-repeat:no-repeat;background-image:url("+n+");width:%?12?%;height:%?22?%}.scan-integral-icon[data-v-33f564e3]{height:%?36?%;width:%?36?%;background-image:url("+o+");background-repeat:no-repeat;background-size:100% auto;margin-left:%?20?%}.scan-integral-switch[data-v-33f564e3]{width:%?44?%;height:%?44?%;background-size:100% auto;background-repeat:no-repeat;float:left}.scan-integral-switch.check[data-v-33f564e3]{margin-left:%?5?%;background-image:url("+s+")}.scan-integral-switch.uncheck[data-v-33f564e3]{margin-left:%?5?%;background-image:url("+r+")}.scan-input[data-v-33f564e3]{width:100%;font-size:%?28?%;color:#666}.scan-remark[data-v-33f564e3]{height:%?106?%}.scan-remark .key[data-v-33f564e3]{margin-left:auto;color:#353535;font-size:%?28?%}.scan-remark .value[data-v-33f564e3]{margin-left:%?10?%;color:#ff4544;font-size:%?36?%}.scan-end[data-v-33f564e3]{color:#666;background:#fff;margin:0 %?24?%;font-size:%?28?%;border-radius:%?16?%;padding:%?40?%}.scan-end uni-text[data-v-33f564e3]{word-break:break-all;text-align:justify}.scan-end>uni-view[data-v-33f564e3]{margin-bottom:%?12?%}.scan-end .icon[data-v-33f564e3]{height:%?26?%;width:%?8?%;border-radius:%?4?%;background:#ff4544;margin-right:%?16?%}.scan-btn[data-v-33f564e3]{margin:%?40?% auto}.scan-modal[data-v-33f564e3]{position:fixed;left:0;top:0;width:100%;height:100%;z-index:2001;-webkit-transition:.2s;-o-transition:.2s;transition:.2s}.scan-modal.show[data-v-33f564e3]{visibility:visible;opacity:1}.scan-modal.bt[data-v-33f564e3]{-webkit-animation-name:fadeIn;-webkit-animation-duration:.25s;-webkit-animation-iteration-count:1;-webkit-animation-delay:0s}.scan-modal .scan-modal-bg[data-v-33f564e3]{background:rgba(0,0,0,.8);position:fixed;left:0;top:0;width:100%;height:100%;z-index:1}.scan-modal .scan-modal-pic[data-v-33f564e3]{position:fixed;left:0;top:%?188?%;width:100%;height:100%;z-index:1}.scan-modal .scan-modal-close uni-image[data-v-33f564e3]{width:%?50?%;height:%?50?%;margin-top:%?50?%}.scan-modal .info-model[data-v-33f564e3]{height:%?360?%;width:%?620?%;background:#fff;border-radius:%?16?%}.scan-modal .order-title[data-v-33f564e3]{margin:%?48?% 0}.scan-modal .place[data-v-33f564e3]{color:#cdcdcd}.scan-modal .info-box[data-v-33f564e3]{height:%?88?%;width:%?400?%;margin-bottom:%?48?%;border-radius:%?8?%;padding:0 %?24?%;border:1px solid #e2e2e2}.scan-modal .info-input[data-v-33f564e3]{font-size:%?32?%;color:#353535}.scan-modal .info-line[data-v-33f564e3]{height:%?32?%!important;width:1px!important;background:#e2e2e2}.scan-modal .info-end[data-v-33f564e3]{color:#666;height:%?88?%;font-size:%?32?%;border-top:%?1?% solid #e2e2e2;width:100%}.scan-modal .info-end uni-view[data-v-33f564e3]{height:100%;width:100%}body.?%PAGE?%[data-v-33f564e3]{background:#f7f7f7}",""])},afd4:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAYFBMVEUAAAD/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFx/A+xKAAAAH3RSTlMA6dzyFC/u+OMnCriuijh2yR/Qfj8allZQRyKjbWdg2KCSBwAAAVdJREFUOMuN1OmugyAQBeADKCqudam127z/W95MbLgiiny/aHpyMk6p2GvaqhNKie7VpghKB0kbMpBvSvKUI44kNR2qn/AUgk5kXvk3o3MtHA9icemZLrxhTXRpwY/J6doNq4EiVL8FU5QHWBUXFtfFvbDHBsAnlJW42fMLQB/KGiCxuzJ4hrIJgNTe2i/e4V4U2+29TrM59y5687DoTlfF2cJ92vysdwIwZu6mFVl1qtze1MmSgv2cDcAkt70NuRS0PXLXTWzm1eTSkP9nTiSc1hNn/cdASZZoOCNJPXle4e8d9f6GmyrlecjXYXGmarAaBflqwFlPxhP4vfaO3t31NHbePcnfkCNLYRQd+QDwfvBB0iHD4YWi3BH/j82xKqLfBGyOHoLVV9kSG/dwtgOL667gCL5ranjG8mSEB460wo/qASfMvGsvZ4OAoi17qZXSsq/eBVx/znqmOZKtz2YAAAAASUVORK5CYII="},b7d0:function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-layout",[a("v-uni-view",[a("v-uni-view",{staticClass:"scan-head dir-top-nowrap main-center"},[a("v-uni-view",{staticClass:"order-name"},[t._v("订单金额")]),a("v-uni-view",{staticClass:"scan-price dir-left-nowrap cross-bottom",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openPriceModel.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"order-key"},[t._v("￥")]),a("v-uni-view",{staticClass:"order-value"},[t._v(t._s(t.list.price))])],1),a("v-uni-view",{staticClass:"scan-line"}),a("v-uni-view",{staticClass:"dir-left-nowrap cross-center scan-offer"},[a("v-uni-view",{staticClass:"box-grow-1"},[t._v("订单优惠")]),a("v-uni-view",{staticClass:"box-grow-0"},[t.list.preferential_money>0?a("v-uni-view",{staticClass:"red"},[t._v("-￥"+t._s(t.list.preferential_money))]):t.list.price>0?a("v-uni-view",{staticClass:"gray"},[t._v("暂无优惠")]):t._e()],1)],1),a("v-uni-view",{staticClass:"dir-left-nowrap cross-center scan-offer"},[a("v-uni-view",{staticClass:"box-grow-1"},[t._v("优惠券")]),a("v-uni-view",{staticClass:"box-grow-0 coupon-right"},[t.list.coupon_id?a("v-uni-view",{staticClass:"red",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setCoupon.apply(void 0,arguments)}}},[t._v("-￥"+t._s(t.list.coupon_preferential_money))]):t.list.price>0&&t.list.can_coupon_num>0?a("v-uni-view",{staticClass:"gray",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setCoupon.apply(void 0,arguments)}}},[t._v("选择优惠券")]):t.list.price>0?a("v-uni-view",{staticClass:"gray"},[t._v("暂无可用优惠券")]):t._e()],1),a("v-uni-view",{staticClass:"box-grow-0 cross-center"},[a("v-uni-icon",{staticClass:"icon-right",attrs:{type:!0}})],1)],1),t.list.price>0&&t.activity&&t.integral.user_integral_num>=t.integral.member_integral&&t.list.integral_deduction>0?a("v-uni-view",{staticClass:"dir-left-nowrap cross-center scan-offer"},[a("v-uni-view",{staticClass:"box-grow-1 cross-center dir-left-nowrap"},[a("v-uni-view",[a("v-uni-text",[t._v("使用"+t._s(t.list.use_integral_num)+"积分抵扣")]),a("v-uni-text",{staticClass:"red"},[t._v(t._s(t.list.integral_deduction))]),a("v-uni-text",[t._v("元")])],1),a("v-uni-view",{staticClass:"main-center cross-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getIntegralInfo.apply(void 0,arguments)}}},[a("v-uni-icon",{staticClass:"scan-integral-icon",attrs:{type:!0}})],1)],1),a("v-uni-view",{staticClass:"box-grow-0",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleUseIntegral.apply(void 0,arguments)}}},[1==t.list.use_integral?a("v-uni-icon",{staticClass:"scan-integral-switch check",attrs:{type:!0}}):a("v-uni-icon",{staticClass:"scan-integral-switch uncheck",attrs:{type:!0}})],1)],1):t._e(),a("v-uni-view",{staticClass:"dir-left-nowrap scan-offer"},[a("v-uni-input",{staticClass:"scan-input",attrs:{value:t.remark,placeholder:"添加备注"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.bindTextBlur.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"scan-line"}),a("v-uni-view",{staticClass:"scan-remark cross-center dir-left-nowrap main-center"},[a("v-uni-view",{staticClass:"key"},[t._v("应付金额")]),a("v-uni-view",{staticClass:"value"},[t._v("￥"+t._s(t.list.pay_price))])],1)],1),t.setting.btn_text?a("v-uni-view",{staticClass:"main-center cross-center scan-btn"},[a("app-button",{attrs:{color:"#ffffff","font-size":"32",height:"88",width:"702","border-color":"#ffffff",background:t.list.price>0?"#ff4544":"#cdcdcd",disabled:t.list.price<=0,round:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.afterSubmit.apply(void 0,arguments)}}},[t._v(t._s(t.setting.btn_text))])],1):t._e(),t.activity.rules?a("v-uni-view",{staticClass:"scan-end"},[a("v-uni-view",{staticClass:"dir-left-nowrap cross-center"},[a("v-uni-view",{staticClass:"icon"}),a("v-uni-view",[t._v("规则说明")])],1),a("v-uni-text",{attrs:{space:"nbsp"}},[t._v(t._s(t.activity.rules))])],1):t._e()],1),t.price_modal?a("v-uni-view",{staticClass:"scan-modal show bt"},[a("v-uni-view",{staticClass:"scan-modal-bg"}),a("v-uni-view",{staticClass:"scan-modal-pic main-center"},[a("v-uni-view",{staticClass:"info-model cross-center dir-top-nowrap"},[a("v-uni-view",{staticClass:"order-title"},[t._v("订单金额")]),a("v-uni-view",{staticClass:"info-box dir-left-nowrap cross-center"},[a("v-uni-input",{staticClass:"info-input",attrs:{focus:!0,value:t.tmp_price,type:"digit","placeholder-class":"place",placeholder:"输入支付金额"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.setTempInput.apply(void 0,arguments)}}}),a("v-uni-view",[t._v("元")])],1),a("v-uni-view",{staticClass:"info-end dir-left-nowrap cross-center"},[a("v-uni-view",{staticClass:"box-grow-1 main-center cross-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePriceModel.apply(void 0,arguments)}}},[t._v("取消")]),a("v-uni-view",{staticClass:"box-grow-0 info-line"}),a("v-uni-view",{staticClass:"box-grow-1 red main-center cross-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.calcPrice.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1)],1):t._e()],1)},o=[]},cf9d:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAARVBMVEUAAADh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eH////h4eH6+vru7u7m5ubr6+v19fVUDuCAAAAAEHRSTlMA+PBVSIbX0buyqQsjloQkrghmVQAAAQFJREFUOMuVlVcSwyAMRIGAewFc7n/UyMxEcULz7ic8M+tFSOJPozZ9o6RUTW/0KErSg3Q3yUFn0VfrIrWvJDp1YXffTm9J/tz2sNBNiWOVI23e3uQ3R1LR4UtAbaSAL7/sfBnwNiF/mZnvrKGFw2Z00Ka5+WU2S7PvSQW2SKtPJh35tUWR7+5rwpdhz0baKLNkgm2oB/rKVkWQJnjggytHD1STkh1XXMtRaI6iGogWhl1UfRjRO3c+gU/netGw5arpRigOrhqeEvI5LCEYsgH9IBQddCnQdUOFhJQoVPzIs4IeLNIKkCazIu0LaYxIywWbOT4mWGtuAK3waMOHJjSO3yJ4XzI45cwQAAAAAElFTkSuQmCC"},d5e0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("a481"),a("6b54"),a("87b3");var i={name:"index",components:{},data:function(){return{clickSubmit:!1,page_loading:!0,tmp_price:"",clerk_user_id:0,edit_status:!0,price_modal:!1,activity:{},remark:"",integral:{user_integral_num:"0"},template_message_list:[],list:{price:"",pay_price:0,use_integral:0,activity_id:0,coupon_id:0,can_coupon_num:0,integral_explain:[]},clear:!1,setting:{}}},onShow:function(){var t=this,e=t.$store.state.scanCode.userCoupon;if(e?(t.list.coupon_id=-1==e?0:e.id,t.calcPrice()):t.list.coupon_id=0,t.clear){var a=[!0,!1,"","",{price:"",pay_price:0,use_integral:0,activity_id:0,coupon_id:0,can_coupon_num:0,integral_explain:[]}];t.edit_status=a[0],t.clear=a[1],t.remark=a[2],t.tmp_price=a[3],t.list=a[4]}},onLoad:function(t){this.$commonLoad.onload(t);var e=this;if(e.$store.commit("scanCode/mutSetUserCoupon",0),e.clear=!0,t.clerk_user_id&&(e.clerk_user_id=t.clerk_user_id),t.price){var a=[!1,t.price];e.edit_status=a[0],e.tmp_price=a[1],e.calcPrice()}e.$showLoading({text:"加载中"}),e.$request({url:e.$api.scan_code_pay.index}).then((function(t){if(e.$hideLoading(),e.hShareAppMessage(),0===t.code){var a=[t.data.activity?t.data.activity:{},t.data.goods,t.data.integral,t.data.setting,t.data.template];e.activity=a[0],e.goods=a[1],e.integral=a[2],e.setting=a[3],e.template_message_list=a[4]}})).catch((function(t){e.$hideLoading()}))},methods:{hShareAppMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.$shareAppMessage({path:"/plugins/scan_code/index/index",title:"当面付",imageUrl:"",desc:"",params:{}},t)},openPriceModel:function(){this.edit_status&&(this.price_modal=!0)},closePriceModel:function(){this.price_modal=!1},setTempInput:function(t){this.tmp_price=this.money(t.detail.value)},money:function(t){var e=t.toString();return 0==e.indexOf(".")&&(e="0"+e),e=e.replace(/[^\d.]/g,""),e=e.replace(/\.{2,}/g,"."),e=e.replace(".","$#$").replace(/\./g,"").replace("$#$","."),e=e.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),e.indexOf(".")<0&&""!=e&&(e=parseFloat(e)),+e},priceChange:function(){this.tmp_price>1e5&&(this.tmp_price=1e5)},calcPrice:function(){var t=this;t.priceChange(),t.price_modal=!1,t.$showLoading({text:"加载中"}),t.$request({url:t.$api.scan_code_pay.preview,data:{price:t.tmp_price,coupon_id:t.list.coupon_id,use_integral:t.list.use_integral,clerk_user_id:t.clerk_user_id},method:"POST"}).then((function(e){if(t.$hideLoading(),0===e.code){var a=[e.data,e.data.price];t.list=a[0],t.tmp_price=a[1]}else uni.showToast({icon:"none",title:e.msg})})).catch((function(e){t.$hideLoading()}))},handleUseIntegral:function(){var t=this,e=t.list;e.use_integral=1==e.use_integral?0:1,t.calcPrice()},bindTextBlur:function(t){this.remark=t.detail.value},getIntegralInfo:function(t){var e="";this.list.integral_explain.map((function(t){e+="消费满"+t.consume_money+"元，",e+="积分最多可抵"+t.integral_deduction+"元",e+="\r\n"})),uni.showModal({title:"积分抵扣说明",content:e.trim(),showCancel:!1})},setCoupon:function(t){this.clear=!1,uni.navigateTo({url:"/plugins/scan_code/index/coupon?price="+this.list.price+"&coupon_id="+this.list.coupon_id})},afterSubmit:function(){var t=this;if(this.clickSubmit)return!1;this.clickSubmit=!0,console.log(this.template_message_list),this.$subscribe(this.template_message_list).then((function(e){t.submit()})).catch((function(){t.submit()}))},submit:function(t){var e=this;e.list.price&&(e.$showLoading({text:"正在提交"}),e.$request({url:e.$api.scan_code_pay.submit,method:"post",data:{price:e.list.price,coupon_id:e.list.coupon_id,use_integral:e.list.use_integral,remark:e.remark,clerk_user_id:e.clerk_user_id}}).then((function(t){e.$hideLoading(),0===t.code?e.$payment.pay(t.data.pay_id).then((function(a){e.$store.commit("scanCode/mutSetUserCoupon",""),uni.showModal({title:"提示",content:"支付成功",showCancel:!1,success:function(){uni.navigateTo({url:"/pages/order-submit/pay-result?payment_order_union_id="+t.data.pay_id+"&plugin=scan_code_pay"}),e.clear=!0}})})).catch((function(a){e.$showLoading({text:"取消中"}),e.$request({url:e.$api.scan_code_pay.cancel,data:{pay_id:t.data.pay_id},method:"POST"}).then((function(t){e.$hideLoading()})).catch((function(t){e.$hideLoading(),uni.showModal({title:"提示",content:t.msg})}))})):uni.showModal({title:"提示",content:info.msg})})).catch((function(t){e.$hideLoading()})))}}};e.default=i},db8d:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAWCAMAAADD5o0oAAAARVBMVEUAAACZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZkBVNYgAAAAFnRSTlMAgtiokR0V5s+9dmdhUklA8LW0nZx9Nlin2AAAAE9JREFUGNNlz0cOwDAIRFHXOInTy9z/qF7yJVjxJARMuGKwyqKKChT1Qasy1PVAmxZo1zyZDiXoVKqmquaAMS7gan+06+ajiPC6cC52+60f0acDStr+zywAAAAASUVORK5CYII="},ded4:function(t,e,a){var i=a("ab4a");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("faba4846",i,!0,{sourceMap:!1,shadowMode:!1})}}]);